import{Q as E,d as V,h as B,sa as y}from"./chunk-5W4IZ3RP.js";import{B as x,C as O,b,d as _}from"./chunk-PFR6PFSF.js";import"./chunk-AGQBY5K2.js";import"./chunk-UWLOHD45.js";import"./chunk-HCHHWL7J.js";import"./chunk-M5WVG3AD.js";import{D as S,E as M,F as N,m as o,q as C,v as F,y as P}from"./chunk-LVLGNVF2.js";import{C as p,Mb as c,N as h,Vb as l,Wb as m,Xb as g,e as d,hc as v,kb as n,ma as r,t as u,wb as f}from"./chunk-HUEGCCE2.js";var L=(()=>{class a{constructor(){this.formBuilder=r(S),this.route=r(b),this.usersService=r(x),this.router=r(_),this._snackBar=r(O),this.shareStateService=r(y),this.activePageTitle=r(V),this.pageTitle=this.activePageTitle.pageTitle,this.backNavigation=this.activePageTitle.backNavigation,this.userName=this.usersService.userName,this.subscriptions=new d(),this.editMode=!1,this.userId=this.usersService.userId,this.isLoading=this.shareStateService.isLoading;}ngOnInit(){this.pageTitle.set("User profile"),this.backNavigation.set(!0),this._initForm(),this._checkEditMode();}_initForm(){this.form=this.formBuilder.group({id:[""],firstName:["",o.required],lastName:["",o.required],email:["",o.required],phone:["",o.required],profilePicture:[""],address:this.formBuilder.group({street:[""],streetNumber:[""],city:[""],zipCode:[""],country:[""]}),credentials:this.formBuilder.group({title:[""],qualifications:[""],licences:[""],company:[""]}),favorites:this.formBuilder.group({favExercises:[""],favPrograms:[""]})});}_checkEditMode(){if(this.userId()){this.editMode=!0;let i=this.usersService.getUser(this.userId()).subscribe(e=>{let t=e.profilePicture;console.log(e),this.form.get("id")?.setValue(this.userId()),this.form.get("firstName")?.setValue(e.firstName),this.form.get("lastName")?.setValue(e.lastName),this.form.get("email")?.setValue(e.email),this.form.get("phone")?.setValue(e.phone),this.form.get("profilePicture")?.setValue(e.profilePicture),this.form.get("address.street")?.setValue(e.address?.street),this.form.get("address.streetNumber")?.setValue(e.address?.streetNumber),this.form.get("address.city")?.setValue(e.address?.city),this.form.get("address.zipCode")?.setValue(e.address?.zipCode),this.form.get("address.country")?.setValue(e.address?.country),this.form.get("credentials.title")?.setValue(e.credentials?.title),this.form.get("credentials.qualifications")?.setValue(e.credentials?.qualifications),this.form.get("credentials.licences")?.setValue(e.credentials?.licences),this.form.get("credentials.company")?.setValue(e.credentials?.company),this.form.get("favorites.favExercises")?.setValue(e.favorites?.favExercises),this.form.get("favorites.favPrograms")?.setValue(e.favorites?.favPrograms);});this.subscriptions.add(i);}}onSubmit(){if(this.form.invalid){this._snackBar.open("Please enter required fields","",{duration:2e3,panelClass:["custom-snackbar-style"]});return;}this.isLoading.set(!0),console.log(this.form),this.userName.set(this.userForm.firstName.value+" "+this.userForm.lastName.value);let i=new FormData();Object.keys(this.userForm).map(e=>{e==="address"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):e==="credentials"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):e==="favorites"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):i.append(e,this.userForm[e].value);}),this.editMode&&this._updateUser(i);}_updateUser(i){let e=this.usersService.updateUser(i,this.userId()).subscribe(t=>{this.usersService.getFavorites(this.userId()).pipe(h(1)).subscribe(()=>console.log("Thumbnail updated")),console.log(t),this._snackBar.open("User updated","",{duration:2e3,panelClass:["custom-snackbar-style"]}),u(p(1e3)).then(()=>{this.isLoading.set(!1),this.router.navigateByUrl("dashboard");});});this.subscriptions.add(e);}onBack(){this.router.navigateByUrl("");}get userForm(){return this.form.controls;}ngOnDestroy(){this.backNavigation.set(!1),this.subscriptions.unsubscribe();}static{this.ɵfac=function(e){return new(e||a)();};}static{this.ɵcmp=f({type:a,selectors:[["sanareapp-edit-form"]],decls:4,vars:4,consts:[[1,"page-container"],[3,"cancelEvent","submitEvent","pageTitle","cancelButton","submitButton"],[1,"form-wrapper",3,"formGroup"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"ui-page-toolbar",1),v("cancelEvent",function(){return t.onBack();})("submitEvent",function(){return t.onSubmit();}),m(),l(2,"form",2),g(3,"ui-client-full-edit-form"),m()()),e&2&&(n(),c("pageTitle",t.pageTitle())("cancelButton",!0)("submitButton",!0),n(),c("formGroup",t.form));},dependencies:[B,E,M,F,C,N,P],styles:[".fetchingDataSpinner[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;left:4px;right:4px;top:4px;width:calc(100% - 20px);height:100%;border-top-left-radius:16px;border-top-right-radius:16px}.user-title[_ngcontent-%COMP%]{margin-top:6px}.page-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:16px}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{flex:5}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{flex:2}@media (max-width: 599px){.page-container[_ngcontent-%COMP%]{width:100%;max-width:600px;height:fit-content;gap:16px;padding:24px}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{order:1;width:100%}.page-container[_ngcontent-%COMP%]   ui-page-toolbar[_ngcontent-%COMP%]{order:2}}"]});}}return a;})();export{L as UserEditFormComponent};/**i18n:ab11a1dcb816b11965daf92ebc4252f70aaa11f3a07066be31c4bdd61d35557d*/