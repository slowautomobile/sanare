import{_ as y,c as O,s as B,u as E}from"./chunk-PAOOGTP2.js";import"./chunk-5BGGFQ3O.js";import{A as N,B as V,b as v,d as b}from"./chunk-LH6SVMQT.js";import"./chunk-VHNB4KT7.js";import"./chunk-35GOY2OB.js";import"./chunk-ANWCIEHE.js";import"./chunk-W4IPF4JN.js";import{Ab as l,Bb as m,C as p,Cb as h,Ob as g,Ta as n,Uc as o,Yc as _,bb as f,bd as C,e as d,ed as F,jd as P,kd as M,la as r,ld as S,rb as c,t as u}from"./chunk-TDY2EFIK.js";var G=(()=>{class a{constructor(){this.formBuilder=r(P),this.route=r(v),this.usersService=r(N),this.router=r(b),this._snackBar=r(V),this.shareStateService=r(O),this.activePageTitle=r(B),this.pageTitle=this.activePageTitle.pageTitle,this.backNavigation=this.activePageTitle.backNavigation,this.userName=this.usersService.userName,this.subscriptions=new d(),this.editMode=!1,this.userId=this.usersService.userId,this.isLoading=this.shareStateService.isLoading;}ngOnInit(){this.pageTitle.set("User profile"),this.backNavigation.set(!0),this._initForm(),this._checkEditMode();}_initForm(){this.form=this.formBuilder.group({id:[""],firstName:["",o.required],lastName:["",o.required],email:["",o.required],phone:["",o.required],profilePicture:[""],address:this.formBuilder.group({street:[""],streetNumber:[""],city:[""],zipCode:[""],country:[""]}),credentials:this.formBuilder.group({title:[""],qualifications:[""],licences:[""],company:[""]}),favorites:this.formBuilder.group({favExercises:[""],favPrograms:[""]})});}_checkEditMode(){if(this.userId()){this.editMode=!0;let i=this.usersService.getUser(this.userId()).subscribe(e=>{let t=e.profilePicture;console.log(e),this.form.get("id")?.setValue(this.userId()),this.form.get("firstName")?.setValue(e.firstName),this.form.get("lastName")?.setValue(e.lastName),this.form.get("email")?.setValue(e.email),this.form.get("phone")?.setValue(e.phone),this.form.get("profilePicture")?.setValue(e.profilePicture),this.form.get("address.street")?.setValue(e.address?.street),this.form.get("address.streetNumber")?.setValue(e.address?.streetNumber),this.form.get("address.city")?.setValue(e.address?.city),this.form.get("address.zipCode")?.setValue(e.address?.zipCode),this.form.get("address.country")?.setValue(e.address?.country),this.form.get("credentials.title")?.setValue(e.credentials?.title),this.form.get("credentials.qualifications")?.setValue(e.credentials?.qualifications),this.form.get("credentials.licences")?.setValue(e.credentials?.licences),this.form.get("credentials.company")?.setValue(e.credentials?.company),this.form.get("favorites.favExercises")?.setValue(e.favorites?.favExercises),this.form.get("favorites.favPrograms")?.setValue(e.favorites?.favPrograms);});this.subscriptions.add(i);}}onSubmit(){if(this.form.invalid){this._snackBar.open("Please enter required fields","",{duration:2e3,panelClass:["custom-snackbar-style"]});return;}this.isLoading.set(!0),console.log(this.form),this.userName.set(this.userForm.firstName.value+" "+this.userForm.lastName.value);let i=new FormData();Object.keys(this.userForm).map(e=>{e==="address"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):e==="credentials"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):e==="favorites"?Object.keys(this.userForm[e].value).map(t=>{let s=`${e}.${t}`;i.append(t,this.form.get(s)?.value);}):i.append(e,this.userForm[e].value);}),this.editMode&&this._updateUser(i);}_updateUser(i){let e=this.usersService.updateUser(i,this.userId()).subscribe(t=>{console.log(t),this._snackBar.open("User updated","",{duration:2e3,panelClass:["custom-snackbar-style"]}),u(p(1e3)).then(()=>{this.isLoading.set(!1),this.router.navigateByUrl("dashboard");});});this.subscriptions.add(e);}onBack(){this.router.navigateByUrl("");}get userForm(){return this.form.controls;}ngOnDestroy(){this.backNavigation.set(!1),this.subscriptions.unsubscribe();}static{this.ɵfac=function(e){return new(e||a)();};}static{this.ɵcmp=f({type:a,selectors:[["sanareapp-edit-form"]],decls:4,vars:4,consts:[[1,"page-container"],[3,"cancelEvent","submitEvent","pageTitle","cancelButton","submitButton"],[1,"form-wrapper",3,"formGroup"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"ui-page-toolbar",1),g("cancelEvent",function(){return t.onBack();})("submitEvent",function(){return t.onSubmit();}),m(),l(2,"form",2),h(3,"ui-client-full-edit-form"),m()()),e&2&&(n(),c("pageTitle",t.pageTitle())("cancelButton",!0)("submitButton",!0),n(),c("formGroup",t.form));},dependencies:[E,y,M,C,_,S,F],styles:[".user-title[_ngcontent-%COMP%]{margin-top:6px}.page-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:16px}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{flex:5}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{flex:2}@media (max-width: 599px){.page-container[_ngcontent-%COMP%]{width:100%;max-width:600px;height:fit-content;gap:16px;padding:24px}.page-container[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{order:1;width:100%}.page-container[_ngcontent-%COMP%]   ui-page-toolbar[_ngcontent-%COMP%]{order:2}}"]});}}return a;})();export{G as UserEditFormComponent};/**i18n:e9421f27e91e2550a5a0bd03ad694673877e5a8020798e378092da15c61db7f3*/